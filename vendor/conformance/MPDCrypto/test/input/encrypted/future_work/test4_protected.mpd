TODO: support digests (HMAC auth)